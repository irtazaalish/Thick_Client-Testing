# List of tools with download URLs
$tools = @(
    @{
        Name = "IDA Pro"
        Url = "https://out7.hex-rays.com/files/idafree83_windows.exe"
        Arguments = "/S"
    },
    @{
        Name = "x64dbg"
        Url = "https://github.com/x64dbg/x64dbg/releases/download/snapshot/snapshot_2023-08-27_02-11.zip"
        Arguments = ""
    },
    @{
        Name = "Ghidra"
        Url = "https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_10.3.2_build/ghidra_10.3.2_PUBLIC_20230711.zip"
        Arguments = ""
    },
    @{
        Name = "Wireshark"
        Url = "https://2.na.dl.wireshark.org/win64/Wireshark-win64-4.0.8.exe"
        Arguments = "/S"
    }
    # Add more tools here
)

# Destination folder for downloads
$downloadFolder = "C:\Dev"

# Destination folder for installations
$installFolder = "C:\Dev\tools"

# Create the download folder if it doesn't exist
if (-not (Test-Path -Path $downloadFolder -PathType Container)) {
    New-Item -Path $downloadFolder -ItemType Directory
}

# Download and install each tool
foreach ($tool in $tools) {
    $downloadPath = Join-Path -Path $downloadFolder -ChildPath "$($tool.Name)"

    # Download the tool
    Invoke-WebRequest -Uri $tool.Url -OutFile $downloadPath

    # Determine the file extension
    $fileExtension = [System.IO.Path]::GetExtension($downloadPath)

    # Install the tool based on the file extension
    if ($fileExtension -eq ".exe" -or $fileExtension -eq ".msi") {
        Write-Host "Installing $($tool.Name)..."
        Start-Process -FilePath $downloadPath -ArgumentList $tool.Arguments -Wait
        Write-Host "$($tool.Name) installed successfully."
    } elseif ($fileExtension -eq ".zip") {
        Write-Host "Extracting $($tool.Name)..."
        Expand-Archive -Path $downloadPath -DestinationPath $installFolder -Force
        Write-Host "$($tool.Name) extracted successfully."
    } else {
        Write-Host "Unsupported file type for $($tool.Name). Please install manually."
    }
}

Write-Host "All tools have been downloaded and installed."
